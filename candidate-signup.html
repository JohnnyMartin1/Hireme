<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <script> window.FontAwesomeConfig = { autoReplaceSvg: 'nest'};</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        ::-webkit-scrollbar { display: none;}
        body { font-family: 'Inter', sans-serif; }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'navy': '#000080',
                        'light-blue': '#ADD8E6',
                        'light-gray': '#D3D3D3',
                        'brand-gray': '#F8FAFC',
                        'subtle-gray': '#F1F5F9',
                        'text-primary': '#111827',
                        'text-secondary': '#6B7280',
                        'accent-blue': '#2563EB',
                        'accent-cyan': '#14B8A6',
                        'success-green': '#10B981',
                        'error-red': '#EF4444',
                    },
                    keyframes: {
                        'fade-in': {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        'pop-in': {
                           '0%': { opacity: '0', transform: 'scale(0.95)' },
                           '100%': { opacity: '1', transform: 'scale(1)' },
                        },
                        'spin': {
                            '0%': { transform: 'rotate(0deg)' },
                            '100%': { transform: 'rotate(360deg)' }
                        }
                    },
                    animation: {
                        'fade-in': 'fade-in 0.5s ease-out forwards',
                        'pop-in': 'pop-in 0.3s ease-out forwards',
                        'spin': 'spin 1s linear infinite',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-brand-gray overflow-hidden">

<main id="profile-focus-final" class="h-screen flex">
    <!-- Left Column - Content & Form -->
    <div id="left-column-final" class="w-[48%] flex flex-col justify-between p-8 bg-white relative">
        <header id="header" class="flex items-center justify-between mb-8">
            <div class="flex items-center space-x-3">
                <svg class="h-8 w-8 text-navy" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="m21 21-4.35-4.35"/>
                    <circle cx="11" cy="8" r="2"/>
                    <path d="M11 12a3 3 0 0 0-3 3h6a3 3 0 0 0-3-3z"/>
                </svg>
                <span class="font-bold text-2xl text-navy">HireMe</span>
            </div>
            <nav class="flex items-center space-x-6 text-text-secondary font-medium">
                <span class="hover:text-text-primary transition-colors cursor-pointer">Explore</span>
                <span class="px-5 py-2 bg-navy text-white font-semibold rounded-lg hover:bg-opacity-90 transition-all duration-200 cursor-pointer">Get Started</span>
            </nav>
        </header>

        <div id="signup-content-final" class="flex-grow flex flex-col justify-center">
            <div id="progress-stepper-final" class="flex items-center space-x-4 text-sm mb-8">
                <div id="step-1" class="flex items-center text-navy font-semibold">
                    <span class="flex items-center justify-center w-8 h-8 bg-navy text-white rounded-full mr-3 text-xs">
                        <i class="fa-solid fa-envelope"></i>
                    </span>
                    Search
                </div>
                <i class="fa-solid fa-chevron-right text-light-gray text-xs"></i>
                <div id="step-2" class="flex items-center text-text-secondary">
                    <span class="flex items-center justify-center w-8 h-8 bg-light-gray text-text-secondary rounded-full mr-3 text-xs">
                        <i class="fa-solid fa-user-plus"></i>
                    </span>
                    Create Account
                </div>
                <i class="fa-solid fa-chevron-right text-light-gray text-xs"></i>
                <div id="step-3" class="flex items-center text-text-secondary">
                    <span class="flex items-center justify-center w-8 h-8 bg-light-gray text-text-secondary rounded-full mr-3 text-xs">
                        <i class="fa-solid fa-smile"></i>
                    </span>
                    Personalize
                </div>
            </div>

            <div class="w-full bg-light-gray rounded-full h-2 mb-8">
                <div id="progress-bar" class="bg-navy h-2 rounded-full transition-all duration-300" style="width: 33.33%"></div>
            </div>

            <!-- Step 1: Verify Email -->
            <div id="step-1-content" class="step-content">
                <h1 class="text-4xl font-bold text-text-primary mb-6">Enter your email to get started</h1>
                <form id="email-form" class="space-y-6">
                    <div class="relative">
                        <input 
                            type="email" 
                            id="email-input" 
                            placeholder="Enter your email address"
                            class="w-full bg-white border border-light-gray rounded-xl py-4 px-6 text-text-primary focus:border-navy focus:outline-none transition-all duration-200 text-lg"
                            required
                        >
                        <button 
                            type="button" 
                            id="send-code-btn" 
                            class="absolute right-2 top-1/2 -translate-y-1/2 bg-navy text-white px-6 py-2 rounded-lg hover:bg-opacity-90 transition-all duration-200 font-medium"
                        >
                            Send Code
                        </button>
                    </div>
                    <p class="text-sm text-text-secondary">We'll email a 6-digit code to verify your address.</p>
                    
                    <div id="code-section" class="hidden space-y-6">
                        <div id="success-message" class="text-sm text-success-green"></div>
                        <div class="flex space-x-3">
                            <input type="text" maxlength="1" class="code-input w-14 h-14 text-center text-xl font-bold border border-light-gray rounded-xl focus:border-navy focus:outline-none transition-all duration-200">
                            <input type="text" maxlength="1" class="code-input w-14 h-14 text-center text-xl font-bold border border-light-gray rounded-xl focus:border-navy focus:outline-none transition-all duration-200">
                            <input type="text" maxlength="1" class="code-input w-14 h-14 text-center text-xl font-bold border border-light-gray rounded-xl focus:border-navy focus:outline-none transition-all duration-200">
                            <input type="text" maxlength="1" class="code-input w-14 h-14 text-center text-xl font-bold border border-light-gray rounded-xl focus:border-navy focus:outline-none transition-all duration-200">
                            <input type="text" maxlength="1" class="code-input w-14 h-14 text-center text-xl font-bold border border-light-gray rounded-xl focus:border-navy focus:outline-none transition-all duration-200">
                            <input type="text" maxlength="1" class="code-input w-14 h-14 text-center text-xl font-bold border border-light-gray rounded-xl focus:border-navy focus:outline-none transition-all duration-200">
                        </div>
                        <div id="code-error" class="text-sm text-error-red hidden"></div>
                        <button type="button" id="verify-btn" class="w-full bg-navy text-white py-4 rounded-xl font-semibold hover:bg-opacity-90 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed">
                            Verify Code
                        </button>
                    </div>
                </form>
            </div>

            <!-- Step 2: Create Account -->
            <div id="step-2-content" class="step-content hidden">
                <h1 class="text-4xl font-bold text-text-primary mb-6">Create your account</h1>
                <form id="account-form" class="space-y-6">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <input 
                                type="text" 
                                id="first-name" 
                                placeholder="First name"
                                class="w-full bg-white border border-light-gray rounded-xl py-4 px-6 text-text-primary focus:border-navy focus:outline-none transition-all duration-200"
                                required
                            >
                        </div>
                        <div>
                            <input 
                                type="text" 
                                id="last-name" 
                                placeholder="Last name"
                                class="w-full bg-white border border-light-gray rounded-xl py-4 px-6 text-text-primary focus:border-navy focus:outline-none transition-all duration-200"
                                required
                            >
                        </div>
                    </div>
                    
                    <div class="relative">
                        <input 
                            type="email" 
                            id="verified-email" 
                            readonly
                            class="w-full bg-gray-50 border-2 border-success-green rounded-xl py-4 px-6 pr-20 text-text-primary"
                        >
                        <span class="absolute right-3 top-1/2 -translate-y-1/2 bg-success-green text-white px-3 py-1 rounded-full text-xs font-medium">
                            <i class="fa-solid fa-check mr-1"></i>Verified
                        </span>
                    </div>

                    <div class="space-y-4">
                        <div class="relative">
                            <input 
                                type="password" 
                                id="password" 
                                placeholder="Password"
                                class="w-full bg-white border border-light-gray rounded-xl py-4 px-6 pr-12 text-text-primary focus:border-navy focus:outline-none transition-all duration-200"
                                required
                            >
                            <button type="button" id="toggle-password" class="absolute right-4 top-1/2 -translate-y-1/2 text-text-secondary hover:text-text-primary">
                                <i class="fa-solid fa-eye"></i>
                            </button>
                        </div>
                        <div id="password-strength" class="text-sm">
                            <div class="flex space-x-2 mb-2">
                                <div class="flex-1 h-2 bg-light-gray rounded-full">
                                    <div id="strength-bar" class="h-2 rounded-full transition-all duration-200" style="width: 0%"></div>
                                </div>
                            </div>
                            <span id="strength-text" class="text-text-secondary">8+ chars, 1 number, 1 letter</span>
                        </div>
                    </div>

                    <div class="relative">
                        <input 
                            type="password" 
                            id="confirm-password" 
                            placeholder="Confirm password"
                            class="w-full bg-white border border-light-gray rounded-xl py-4 px-6 pr-12 text-text-primary focus:border-navy focus:outline-none transition-all duration-200"
                            required
                        >
                        <div id="password-match" class="absolute right-4 top-1/2 -translate-y-1/2 hidden">
                            <i class="fa-solid fa-check text-success-green"></i>
                        </div>
                    </div>

                    <button type="submit" id="create-account-btn" class="w-full bg-navy text-white py-4 rounded-xl font-semibold hover:bg-opacity-90 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        Create Account
                    </button>
                </form>
            </div>

            <!-- Step 3: Welcome -->
            <div id="step-3-content" class="step-content hidden text-center">
                <div class="space-y-8">
                    <h1 id="welcome-title" class="text-4xl font-bold text-text-primary opacity-0 transform translate-y-4 transition-all duration-300">
                        Welcome, <span id="user-first-name">User</span> — ready to get hired?
                    </h1>
                    <p id="welcome-subtitle" class="text-lg text-text-secondary opacity-0 transform translate-y-4 transition-all duration-300" style="transition-delay: 100ms">
                        Let's finish setting up your profile so employers can discover your amazing potential.
                    </p>
                    <button id="start-profile-btn" class="bg-navy text-white px-8 py-4 rounded-xl font-semibold hover:bg-opacity-90 transition-all duration-200 opacity-0 transform translate-y-4" style="transition-delay: 200ms">
                        Start profile setup
                        <i class="fa-solid fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <footer id="footer" class="text-center text-xs text-text-secondary mt-8">
            <p>&copy; 2025 HireMe Inc. &nbsp;&bull;&nbsp; <span class="hover:underline cursor-pointer">Privacy</span> &nbsp;&bull;&nbsp; <span class="hover:underline cursor-pointer">Terms</span></p>
        </footer>
    </div>

    <!-- Right Column - Profile Gallery -->
    <div id="right-column-final" class="w-[52%] bg-brand-gray p-8 overflow-hidden relative">
        <div id="gallery-background" class="absolute inset-0 bg-gradient-to-br from-brand-gray via-subtle-gray to-brand-gray"></div>
        
        <div id="profile-gallery-container" class="h-full w-full relative">
            <div id="profile-grid-final" class="grid grid-cols-4 gap-4 h-full content-start">
                <!-- Profile cards generated by JavaScript -->
            </div>
            
            <!-- Focused Card Overlay -->
            <div id="focused-card-overlay" class="absolute opacity-0 pointer-events-none transition-opacity duration-200 z-10" style="left: 50%; top: 50%; transform: translate(-50%, -50%);">
                <div id="focused-card" class="bg-white rounded-2xl shadow-lg p-8 flex flex-col items-center justify-center space-y-6 border border-navy/10 transition-all duration-320" style="transition-timing-function: cubic-bezier(0.22, 1, 0.36, 1);">
                    <div class="w-20 h-20 bg-light-gray rounded-full flex items-center justify-center transition-colors duration-200">
                        <svg class="w-12 h-12 text-text-secondary" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <div class="text-center">
                        <div id="preview-fullname" class="text-2xl font-bold text-text-primary">Full Name</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const grid = document.getElementById('profile-grid-final');
    const progressBar = document.getElementById('progress-bar');
    
    // Step elements
    const step1 = document.getElementById('step-1');
    const step2 = document.getElementById('step-2');
    const step3 = document.getElementById('step-3');
    const step1Content = document.getElementById('step-1-content');
    const step2Content = document.getElementById('step-2-content');
    const step3Content = document.getElementById('step-3-content');
    
    let currentStep = 1;
    let userEmail = '';
    let userFirstName = '';
    
    // Generate Profile Cards
    for (let i = 0; i < 32; i++) {
        const card = document.createElement('div');
        card.className = 'profile-card bg-white rounded-xl p-4 shadow-sm border border-gray-200/50 aspect-[3/4] flex flex-col items-center justify-center space-y-3 transition-all duration-300 hover:shadow-md hover:-translate-y-1 opacity-0 animate-fade-in';
        card.style.animationDelay = `${i * 30}ms`;
        
        card.innerHTML = `
            <div class="w-12 h-12 bg-light-gray rounded-full flex items-center justify-center">
                <svg class="w-7 h-7 text-text-secondary" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
                </svg>
            </div>
            <div class="w-3/4 h-2 bg-light-gray rounded-full"></div>
            <div class="w-1/2 h-2 bg-light-gray rounded-full"></div>
        `;
        
        grid.appendChild(card);
    }

    // Step 1: Email Verification
    const emailForm = document.getElementById('email-form');
    const emailInput = document.getElementById('email-input');
    const sendCodeBtn = document.getElementById('send-code-btn');
    const codeSection = document.getElementById('code-section');
    const successMessage = document.getElementById('success-message');
    const codeInputs = document.querySelectorAll('.code-input');
    const verifyBtn = document.getElementById('verify-btn');
    const codeError = document.getElementById('code-error');

    sendCodeBtn.addEventListener('click', () => {
        const email = emailInput.value.trim();
        if (!email || !isValidEmail(email)) return;
        
        userEmail = email;
        sendCodeBtn.innerHTML = '<i class="fa-solid fa-spinner animate-spin"></i>';
        sendCodeBtn.disabled = true;
        
        setTimeout(() => {
            sendCodeBtn.innerHTML = 'Sent';
            successMessage.innerHTML = `Code sent to ${email} · <button type="button" id="resend-btn" class="text-navy hover:underline">didn't get it? Resend in 30s</button>`;
            codeSection.classList.remove('hidden');
            codeInputs[0].focus();
        }, 800);
    });

    // Code input auto-advance
    codeInputs.forEach((input, index) => {
        input.addEventListener('input', (e) => {
            if (e.target.value && index < codeInputs.length - 1) {
                codeInputs[index + 1].focus();
            }
            checkCodeComplete();
        });
        
        input.addEventListener('keydown', (e) => {
            if (e.key === 'Backspace' && !e.target.value && index > 0) {
                codeInputs[index - 1].focus();
            }
        });
    });

    function checkCodeComplete() {
        const code = Array.from(codeInputs).map(input => input.value).join('');
        if (code.length === 6) {
            verifyCode(code);
        }
    }

    verifyBtn.addEventListener('click', () => {
        const code = Array.from(codeInputs).map(input => input.value).join('');
        if (code.length === 6) {
            verifyCode(code);
        }
    });

    function verifyCode(code) {
        verifyBtn.innerHTML = '<i class="fa-solid fa-spinner animate-spin"></i>';
        verifyBtn.disabled = true;
        
        setTimeout(() => {
            const isValid = code === '123456'; // Simulate validation
            if (isValid) {
                nextStep();
            } else {
                codeError.textContent = 'Code incorrect. Try again.';
                codeError.classList.remove('hidden');
                verifyBtn.innerHTML = 'Verify Code';
                verifyBtn.disabled = false;
            }
        }, 600);
    }

    // Step 2: Create Account
    const accountForm = document.getElementById('account-form');
    const firstNameInput = document.getElementById('first-name');
    const lastNameInput = document.getElementById('last-name');
    const verifiedEmailInput = document.getElementById('verified-email');
    const passwordInput = document.getElementById('password');
    const confirmPasswordInput = document.getElementById('confirm-password');
    const togglePasswordBtn = document.getElementById('toggle-password');
    const strengthBar = document.getElementById('strength-bar');
    const strengthText = document.getElementById('strength-text');
    const passwordMatch = document.getElementById('password-match');
    const createAccountBtn = document.getElementById('create-account-btn');

    // Password visibility toggle
    togglePasswordBtn.addEventListener('click', () => {
        const type = passwordInput.type === 'password' ? 'text' : 'password';
        passwordInput.type = type;
        togglePasswordBtn.querySelector('i').className = type === 'password' ? 'fa-solid fa-eye' : 'fa-solid fa-eye-slash';
    });

    // Password strength checker
    passwordInput.addEventListener('input', checkPasswordStrength);
    confirmPasswordInput.addEventListener('input', checkPasswordMatch);
    firstNameInput.addEventListener('input', validateForm);
    lastNameInput.addEventListener('input', validateForm);

    function checkPasswordStrength() {
        const password = passwordInput.value;
        let strength = 0;
        
        if (password.length >= 8) strength += 1;
        if (/[0-9]/.test(password)) strength += 1;
        if (/[a-zA-Z]/.test(password)) strength += 1;
        if (/[^a-zA-Z0-9]/.test(password)) strength += 1;
        
        const percentage = (strength / 4) * 100;
        strengthBar.style.width = `${percentage}%`;
        
        if (strength <= 1) {
            strengthBar.className = 'h-2 rounded-full transition-all duration-200 bg-error-red';
            strengthText.textContent = 'Weak';
            strengthText.className = 'text-error-red';
        } else if (strength <= 2) {
            strengthBar.className = 'h-2 rounded-full transition-all duration-200 bg-yellow-500';
            strengthText.textContent = 'Okay';
            strengthText.className = 'text-yellow-500';
        } else {
            strengthBar.className = 'h-2 rounded-full transition-all duration-200 bg-success-green';
            strengthText.textContent = 'Strong';
            strengthText.className = 'text-success-green';
        }
        
        validateForm();
    }

    function checkPasswordMatch() {
        const match = passwordInput.value === confirmPasswordInput.value && confirmPasswordInput.value.length > 0;
        passwordMatch.classList.toggle('hidden', !match);
        confirmPasswordInput.style.borderColor = match ? '#10B981' : '';
        validateForm();
    }

    function validateForm() {
        const isValid = firstNameInput.value.trim() && 
                       lastNameInput.value.trim() && 
                       passwordInput.value.length >= 8 && 
                       passwordInput.value === confirmPasswordInput.value;
        
        createAccountBtn.disabled = !isValid;
    }

    accountForm.addEventListener('submit', (e) => {
        e.preventDefault();
        userFirstName = firstNameInput.value.trim();
        
        createAccountBtn.innerHTML = '<i class="fa-solid fa-spinner animate-spin"></i>';
        createAccountBtn.disabled = true;
        
        setTimeout(() => {
            // Trigger focused card animation and step transition
            triggerFocusedCardAnimation();
            nextStep();
        }, 800);
    });

    // Focused Card Animation System
    function triggerFocusedCardAnimation() {
        const focusedOverlay = document.getElementById('focused-card-overlay');
        const focusedCard = document.getElementById('focused-card');
        const rightPane = document.getElementById('right-column-final');
        const cards = grid.querySelectorAll('.profile-card');
        const targetCard = cards[15]; // Center card
        
        // Step A (First): Read target card position relative to RIGHT-PANE
        const targetRect = targetCard.getBoundingClientRect();
        const rightPaneRect = rightPane.getBoundingClientRect();
        
        // Calculate source position relative to right pane
        const sourceX = targetRect.left - rightPaneRect.left + (targetRect.width / 2);
        const sourceY = targetRect.top - rightPaneRect.top + (targetRect.height / 2);
        const sourceScale = targetRect.width / 400; // Assuming 400px final width
        
        // Step B (Last): Calculate final centered position within right pane
        const finalWidth = Math.min(400, rightPaneRect.width - 64); // 32px margin each side
        const finalHeight = 320; // Keep aspect ratio
        const finalX = rightPaneRect.width / 2;
        const finalY = rightPaneRect.height / 2;
        const finalScale = 1;
        
        // Set transform-origin to top-left for stable transforms
        focusedCard.style.transformOrigin = 'top left';
        
        // Step C (Invert): Set initial position to match target card
        const initialTranslateX = sourceX - finalX;
        const initialTranslateY = sourceY - finalY;
        
        // Apply initial transform (source position and scale)
        focusedCard.style.transform = `translate(${initialTranslateX}px, ${initialTranslateY}px) translate(-50%, -50%) scale(${sourceScale})`;
        focusedCard.style.opacity = '0';
        focusedCard.style.width = `${finalWidth}px`;
        focusedCard.style.height = `${finalHeight}px`;
        
        // Show overlay
        focusedOverlay.style.opacity = '1';
        focusedOverlay.style.pointerEvents = 'auto';
        
        // Apply backdrop effects to grid
        grid.style.filter = 'blur(6px)';
        grid.style.opacity = '0.88';
        grid.style.transition = 'filter 220ms ease-out, opacity 220ms ease-out';
        grid.style.pointerEvents = 'none';
        
        // Animate to final centered position
        requestAnimationFrame(() => {
            focusedCard.style.transition = 'transform 320ms cubic-bezier(0.22, 1, 0.36, 1), opacity 180ms ease-out';
            // Final transform centers the card in the right pane
            focusedCard.style.transform = `translate(-50%, -50%)`;
            focusedCard.style.opacity = '1';
            
            // Position the overlay at the center of right pane
            focusedOverlay.style.left = `${finalX}px`;
            focusedOverlay.style.top = `${finalY}px`;
            focusedOverlay.style.transform = 'translate(-50%, -50%)';
            
            // Update content after animation starts
            setTimeout(() => {
                updateFocusedCardContent();
                // Apply success state
                applySuccessState();
            }, 160);
        });
    }

    function updateFocusedCardContent() {
        const fullNameDiv = document.getElementById('preview-fullname');
        const firstName = firstNameInput.value.trim();
        const lastName = lastNameInput.value.trim();
        
        // Update content with full name only
        fullNameDiv.textContent = `${firstName} ${lastName}`;
        
        // Animate content reveal
        fullNameDiv.style.opacity = '0';
        fullNameDiv.style.transform = 'translateY(6px)';
        
        setTimeout(() => {
            fullNameDiv.style.transition = 'opacity 120ms ease-out, transform 120ms ease-out';
            fullNameDiv.style.opacity = '1';
            fullNameDiv.style.transform = 'translateY(0)';
        }, 40);
    }

    function applySuccessState() {
        const focusedCard = document.getElementById('focused-card');
        const avatarContainer = focusedCard.querySelector('.w-20.h-20');
        
        // Apply success outline and glow
        focusedCard.style.border = '2px solid #10B981';
        focusedCard.style.boxShadow = '0 0 0 3px rgba(16, 185, 129, 0.3), 0 20px 25px -5px rgba(0, 0, 0, 0.1)';
        
        // Apply avatar tint
        avatarContainer.style.backgroundColor = 'rgba(16, 185, 129, 0.1)';
        
        // Pulse animation
        focusedCard.style.animation = 'none';
        setTimeout(() => {
            focusedCard.style.animation = 'pulse-glow 280ms ease-out';
        }, 10);
        
        // Announce for accessibility
        const ariaLive = document.querySelector('[aria-live="polite"]');
        if (ariaLive) {
            ariaLive.textContent = 'Account created successfully. Focused preview shown.';
        }
    }

    // Add CSS animation for pulse glow
    const style = document.createElement('style');
    style.textContent = `
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3), 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
            50% { box-shadow: 0 0 0 6px rgba(16, 185, 129, 0.4), 0 25px 35px -5px rgba(0, 0, 0, 0.15); }
            100% { box-shadow: 0 0 0 3px rgba( * 185, 129, 0.3), 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        }
    `;
    document.head.appendChild(style);

    function showStep(stepNumber) {
        [step1Content, step2Content, step3Content].forEach((content, index) => {
            if (index + 1 === stepNumber) {
                content.classList.remove('hidden');
                content.style.opacity = '0';
                content.style.transform = 'translateY(12px)';
                
                setTimeout(() => {
                    content.style.transition = 'opacity 180ms ease-out, transform 180ms ease-out';
                    content.style.opacity = '1';
                    content.style.transform = 'translateY(0)';
                }, 50);
                
                // Special handling for step 2 and 3
                if (stepNumber === 2) {
                    verifiedEmailInput.value = userEmail;
                } else if (stepNumber === 3) {
                    userFirstNameSpan.textContent = userFirstName;
                    
                    // Animate welcome elements with staggered timing
                    setTimeout(() => {
                        welcomeTitle.style.transition = 'opacity 220ms ease-out, transform 220ms ease-out';
                        welcomeTitle.style.opacity = '1';
                        welcomeTitle.style.transform = 'translateY(0)';
                    }, 100);
                    
                    setTimeout(() => {
                        welcomeSubtitle.style.transition = 'opacity 220ms ease-out, transform 220ms ease-out';
                        welcomeSubtitle.style.opacity = '1';
                        welcomeSubtitle.style.transform = 'translateY(0)';
                    }, 200);
                    
                    setTimeout(() => {
                        startProfileBtn.style.transition = 'opacity 120ms ease-out, transform 120ms ease-out';
                        startProfileBtn.style.opacity = '1';
                        startProfileBtn.style.transform = 'translateY(0)';
                    }, 320);
                }
            } else {
                content.classList.add('hidden');
            }
        });
    }

    // Enhanced mouse parallax effect (only active in gallery state, disabled when focused)
    document.addEventListener('mousemove', (e) => {
        if (currentStep !== 3 || document.getElementById('focused-card-overlay').classList.contains('opacity-100')) return;
        
        const cards = grid.querySelectorAll('.profile-card');
        const mouseX = (e.clientX / window.innerWidth - 0.5) * 2;
        const mouseY = (e.clientY / window.innerHeight - 0.5) * 2;
        
        cards.forEach((card, index) => {
            const intensity = Math.sin(index * 0.5) * 1.5;
            const translateX = mouseX * intensity;
            const translateY = mouseY * intensity;
            
            card.style.transform = `translate(${translateX}px, ${translateY}px)`;
            card.style.transition = 'transform 100ms ease-out';
        });
    });

    // Add ARIA live region for accessibility
    const ariaLive = document.createElement('div');
    ariaLive.setAttribute('aria-live', 'polite');
    ariaLive.className = 'sr-only';
    document.body.appendChild(ariaLive);

    // Update ARIA announcements in nextStep function
    function nextStep() {
        applyGridEffect();
        
        setTimeout(() => {
            currentStep++;
            updateProgress();
            showStep(currentStep);
            
            // Announce step changes
            if (currentStep === 3) {
                ariaLive.textContent = 'Personalize step. Focused preview shown.';
            }
            
            removeGridEffect();
        }, 200);
    }

    function updateProgress() {
        const percentage = (currentStep / 3) * 100;
        progressBar.style.width = `${percentage}%`;
        
        // Update step indicators
        [step1, step2, step3].forEach((step, index) => {
            const stepNum = index + 1;
            const icon = step.querySelector('span');
            const isActive = stepNum === currentStep;
            const isCompleted = stepNum < currentStep;
            
            if (isCompleted) {
                step.classList.add('text-success-green', 'font-semibold');
                step.classList.remove('text-text-secondary');
                icon.classList.add('bg-success-green');
                icon.classList.remove('bg-light-gray', 'bg-navy');
                icon.innerHTML = '<i class="fa-solid fa-check"></i>';
            } else if (isActive) {
                step.classList.add('text-navy', 'font-semibold');
                step.classList.remove('text-text-secondary');
                icon.classList.add('bg-navy');
                icon.classList.remove('bg-light-gray');
            } else {
                step.classList.add('text-text-secondary');
                step.classList.remove('text-navy', 'text-success-green', 'font-semibold');
                icon.classList.add('bg-light-gray');
                icon.classList.remove('bg-navy', 'bg-success-green');
            }
        });
    }

    function applyGridEffect() {
        grid.style.filter = 'blur(6px)';
        grid.style.opacity = '0.4';
        grid.style.transition = 'filter 200ms ease-out, opacity 200ms ease-out';
    }

    function removeGridEffect() {
        setTimeout(() => {
            grid.style.filter = 'none';
            grid.style.opacity = '1';
        }, 100);
    }

    // Helper functions
    function isValidEmail(email) {
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }

    // Step 3: Welcome
    const welcomeTitle = document.getElementById('welcome-title');
    const welcomeSubtitle = document.getElementById('welcome-subtitle');
    const startProfileBtn = document.getElementById('start-profile-btn');
    const userFirstNameSpan = document.getElementById('user-first-name');

    startProfileBtn.addEventListener('click', () => {
        // Route to profile customization carousel
        console.log('Routing to profile setup...');
    });
});
</script>

</body>
</html>
